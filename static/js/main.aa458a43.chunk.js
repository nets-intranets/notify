(this["webpackJsonpztickybar-alarms"]=this["webpackJsonpztickybar-alarms"]||[]).push([[0],{134:function(e,t){e.exports="data:image/png;base64,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"},149:function(e,t){},213:function(e,t,n){var r=n(269),o=n(102),i=n(270);e.exports=function(e,t){var n=t.body;if(!n)return e.done("Missing a request body");if(!n.action)return e.done("Missing a body.action parameter");function o(t,n){return t?(e.log(r.plain(t)),e.res={error:t},e.done()):(e.log(r.plain(n)),e.res={data:Array.isArray(n)?n:[n]},e.done())}c.getAccessToken().then((function(e){var t=n.action.toLowerCase();switch(t){case"manager":a.readManager(e,n.query,0,o);break;case"newdoc":var r=(w=n.query.split("|")).length>0?w[0]:"",i=w.length>1?w[1]:"/",c=w.length>1?w[2]:"/",s=w.length>1?w[3]:"/",u=w.length>1?w[4]:"/";a.newDoc(e,r,i,c,s,u,o);break;case"getgroupdrive":var l=(w=n.query.split("|")).length>0?w[0]:"";a.getGroupDrive(e,l,o);break;case"getgroupsite":l=(w=n.query.split("|")).length>0?w[0]:"";a.getGroupSite(e,l,o);break;case"memberof":a.readGroupMemberShipFor(e,n.query,o);break;case"matchinggroups":a.matchingGroups(e,n.query,o);break;case"getgroupdocs":l=(w=n.query.split("|")).length>0?w[0]:"";var p=w.length>1?w[1]:"/";a.getGroupDocuments(e,l,p,o);break;case"sharepointlist":var f=(w=n.query.split("|")).length>0?w[0]:"",d=w.length>1?w[1]:"",m=w.length>2?w[2]:"",h=w.length>3?w[3]:"",g=w.length>4?w[4]:"";a.getSharePointList(e,f,d,m,h,g,o);break;case"getgrouprootfolders":l=(w=n.query.split("|")).length>0?w[0]:"";a.getGroupRootFolders(e,l,o);break;case"getdrivechildren":c=(w=n.query.split("|")).length>0?w[0]:"",i=w.length>1?w[1]:"";a.getDriveChildren(e,c,i,o);break;case"collaboratewith":a.analyseMembers(e,n.query,o);break;case"invite":var v=(w=n.query.split("|"))[0];l=w[1];a.invite(e,v,"https://teams.microsoft.com/l/team/19%3a0e28628caa7745af8d1be8b1291d3fe8%40thread.skype/conversations?groupId=b4cc43ed-537d-4111-907d-a8eb4dabd7e8&tenantId=df96b8c9-51a1-40cf-b8b1-4514be8e9668",o);break;case"addcrm":var w=n.query.split("|");a.addcrm(e,w[0],w[1],w[2],w[3],o);break;case"addmember":v=(w=n.query.split("|"))[0],l=w[1];a.addmember(e,v,l,o);break;case"copyfile":(w=n.query.split("|")).length<5?o("Wrong number of parameters "):a.copyfile(e,w[0],w[1],w[2],w[3],w[4],o);break;default:o("Unsupported "+t)}}),(function(e){console.log(e)}))};var a={};a.analyseMembers=function(e,t,n){var r=[];t.split("\n").forEach((function(e){e.split(";").forEach((function(e){e.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi).forEach((function(e){r.push({checked:!1,smtp:e})}))}))}));var o=[],i=r.length;r.forEach((function(t){a.readUser(e,t.smtp,0,(function(e,r){i--,t.user=r,t.err=e,o.push(t),i<1&&(n(null,o),t.checked=!0)}))}))},a.invite=function(e,t,n,r){u(e,"https://graph.microsoft.com/v1.0/invitations",{invitedUserEmailAddress:t,inviteRedirectUrl:n,invitedUserDisplayName:t,sendInvitationMessage:!1,invitedUserMessageInfo:{customizedMessageBody:"We are really happy to invite you to the JUMPTO365 #Insider program ",ccRecipients:[{emailAddress:{name:"Niels",address:"niels@jumpto365.com"}}]}},(function(e,t){if(e)return r(e);r(null,t)}))},a.addcrm=function(e,t,n,r,o,a){var c={properties:[{property:"firstname",value:n},{property:"lastname",value:r},{property:"internal_categories",value:o}]};!function(e,t,n,r){i.post({url:t,headers:{"content-type":"application/json"},body:JSON.stringify(n)},(function(e,t,n){var o;return e?r(e):(o=""===n?{}:JSON.parse(n)).error?r(o.error):void r(null,o)}))}(0,"https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/".concat(t,"/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2"),c,(function(e,t){if(e)return a(e);a(null,t)}))},a.addmember=function(e,t,n,r){var o={"@odata.id":"https://graph.microsoft.com/beta/directoryObjects/".concat(t)};u(e,"https://graph.microsoft.com/beta/groups/".concat(n,"/members/$ref"),o,(function(e,t){if(e)return r(e);r(null)}))},a.getSharePointList=function(e,t,n,r,o,i,a){l(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(r,"/items?").concat(o),(function(o,c){if(o)return a(o);var s=[];!function o(){if(0===c.length)return a(null,s);var u=c.pop();l(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(r,"/items/").concat(u.id,"?").concat(i),(function(e,t){if(e)return a(e);s.push(t),o()}))}()}))},a.readGroupMembers=function(e,t,n){l(e,"https://graph.microsoft.com/beta/groups/"+t+"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id",n)},a.readGroupMemberShipFor=function(e,t,n){l(e,"https://graph.microsoft.com/v1.0/users/"+t+"/memberOf",n)},a.readManager=function(e,t,n,r){l(e,"https://graph.microsoft.com/v1.0/users/"+t+"/manager",r,null,n)},a.readUser=function(e,t,n,r){l(e,"https://graph.microsoft.com/v1.0/users/"+t,r,null,n)},a.matchingGroups=function(e,t,n){l(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'".concat(t,"')"),n)},a.findGroup=function(e,t,n){l(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '".concat(t,"'"),n)},a.getGroupDocuments=function(e,t,n,r){l(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root:").concat(n,":/children"),r)},a.getGroupDrive=function(e,t,n){l(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive"),n)},a.getGroupSite=function(e,t,n){l(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/sites/root"),n)},a.getDriveChildren=function(e,t,n,r){l(e,"https://graph.microsoft.com/beta/drives/".concat(t,"/items/").concat(n,"/children"),r)},a.getGroupRootFolders=function(e,t,n){l(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root/children"),n)},a.getSharePointSiteByName=function(e,t,n,r){l(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":/sites/").concat(n),r)},a.getSharePointSiteDrive=function(e,t,n,r){l(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,"/drive/root:/").concat(n,":/children"),r)},a.copyfile=function(e,t,n,r,i,c,s){a.findGroup(e,t,(function(t,u){if(t)return s(t);if(1!==u.length)return s("Did't find a unique group");var l=u[0];a.getGroupDocuments(e,l.id,"/"+n,(function(t,n){if(t)return s(t);var u=o.find(n,{name:r});a.getGroupRootFolders(e,l.id,(function(t,n){if(t)return s(t);var r=o.find(n,{name:i});if(!r)return s("Did't find target folder");a.newDoc(e,l.id,u.id,r.parentReference.driveId,r.id,c,(function(e,t){return e?s(e):s(null,t)}))}))}))}))},a.newDoc=function(e,t,n,r,o,i,c){u(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/").concat(n,"/copy"),{parentReference:{driveId:r,id:o},name:i},(function(t){if(t)return c(t);!function e(t,n,r,o,i,c){a.getDriveChildren(t,n,r,(function(a,s){if(a)return c(a);for(var u=0;u<s.length;u++){var l=s[u];if(console.log("Comparing",l.name,o),l.name===o)return console.log("Match found"),c(null,l)}setTimeout((function(){if(console.log("Retrying",i),i>10)return c("Think that the file has been created, but could not find a reference to if. Filename is ".concat(o," - Tryed ").concat(i," to find it "));e(t,n,r,o,i+1,c)}),1e3)}))}(e,r,o,i,0,c)}))};var c={},s={tokenEndpoint:"https://login.microsoftonline.com/common/oauth2/token"};function u(e,t,n,r){i.post({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var o;return e?r(e):(o=""===n?{}:JSON.parse(n)).error?r(o.error):void r(null,o)}))}function l(e,t,n,r,o,a){console.log("getting",t,!0===r),i.get({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e}},(function(i,c,s){var u,p;if(i){var f=a?a+1:1;return f>3?n(i,null,o):(console.log("retry #",f),l(e,t,n,r,o,f))}return(u=JSON.parse(s)).error?n(u.error,null,o):u["@odata.nextLink"]?(p=r?r.concat(u.value):u.value,l(e,u["@odata.nextLink"],n,p,o)):void(r?n(null,r.concat(u.value),o):u.value?n(null,u.value,o):n(null,u,o))}))}c.getAccessToken=function(){if(window)throw"Not valid client side";return new Promise((function(e,t){var n={grant_type:"client_credentials",client_id:s.clientId,client_secret:s.clientSecret,resource:"https://graph.microsoft.com"};i.post({url:s.tokenEndpoint,form:n},(function(n,r,o){var i=JSON.parse(o);n?t(n):i.error?t(i.error_description):e(i.access_token)}))}))},e.exports.getRaw=function(e,t){return console.log("getting",t),new Promise((function(n,r){i.get({url:t,headers:{authorization:"Bearer "+e}},(function(e,t,r){if(e)return n({hasError:!0,error:e});n({hasError:!1,result:r})}))}))},e.exports.get=function(e,t){return new Promise((function(n,r){l(e,t,(function(e,t){if(e)return r(e);n(t)}))}))},e.exports.post=function(e,t,n){return new Promise((function(r,o){u(e,t,n,(function(e,t){if(e)return o(e);r(t)}))}))},e.exports.patch=function(e,t,n){return new Promise((function(r,o){!function(e,t,n,r){i.patch({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var o;return e?r(e):(o=""===n?{}:JSON.parse(n)).error?r(o.error):void r(null,o)}))}(e,t,n,(function(e,t){if(e)return o(e);r(t)}))}))},e.exports.graph=a,e.exports.auth=c},229:function(e,t,n){e.exports=n(472)},234:function(e,t,n){},257:function(e,t){},258:function(e,t){},263:function(e,t){},265:function(e,t){},311:function(e,t){},312:function(e,t){},377:function(e,t){},470:function(e,t,n){},471:function(e,t){},472:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(59),a=n.n(i),c=(n(234),n(2)),s=n.n(c),u=n(33),l=n(49),p=n(4),f=n(6),d=(n(102),n(42)),m=n(222),h=n(212);function g(){try{return window.self!==window.top}catch(e){return!0}}var v=function(){function e(t,n){Object(p.a)(this,e),this.options=n,this.msalApplication=t}return Object(f.a)(e,[{key:"getAccessToken",value:function(e){var t=this,n=this;return new Promise(function(){var r=Object(u.a)(s.a.mark((function r(o,i){var a,c,u,l,p,f,m,h;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("undefined"!==typeof(a=e)&&(c=a.scopes),"undefined"!==typeof c&&0!==c.length||(c=t.options.scopes),0!==c.length){r.next=8;break}throw(u=new Error).name="EmptyScopes",u.message="Scopes cannot be empty, Please provide a scopes",u;case 8:if(n.msalApplication.handleRedirectCallback((function(e,t){if(e)return i(e)})),!t.msalApplication.getAccount()){r.next=42;break}return l={scopes:c},r.prev=11,r.next=14,t.msalApplication.acquireTokenSilent(l);case 14:p=r.sent,o(p.accessToken),r.next=40;break;case 18:if(r.prev=18,r.t0=r.catch(11),!(r.t0 instanceof d.a)){r.next=38;break}if(r.prev=21,!g()){r.next=29;break}return r.next=25,t.msalApplication.acquireTokenPopup(l);case 25:f=r.sent,o(f.accessToken),r.next=30;break;case 29:case 30:r.next=36;break;case 32:r.prev=32,r.t1=r.catch(21),i(r.t1);case 36:r.next=40;break;case 38:i(r.t0);case 40:r.next=60;break;case 42:if(r.prev=42,m={scopes:c},!g()){r.next=53;break}return r.next=47,t.msalApplication.loginPopup(m);case 47:return r.next=49,t.msalApplication.acquireTokenSilent(m);case 49:h=r.sent,o(h.accessToken),r.next=55;break;case 53:return n.msalApplication.loginRedirect(m),r.abrupt("return");case 55:r.next=60;break;case 57:r.prev=57,r.t2=r.catch(42),i(r.t2);case 60:case"end":return r.stop()}}),r,null,[[11,18],[21,32],[42,57]])})));return function(e,t){return r.apply(this,arguments)}}())}}]),e}(),w=(n(238),n(134)),b=n.n(w),A={clientId:"3befe8c6-843e-4f4f-8b5b-b8e37174b961",scopes:["user.readwrite","Sites.Read.All"],title:"Alerts",logo:b.a,currentAlerts:"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields",alertsUrl:"https://christianiabpos.sharepoint.com/sites/intranets-corp/lists/currentAlerts",components:{header:o.a.createElement("div",{style:{borderBottom:"1px solid #cccccc"}},o.a.createElement("div",{style:{display:"flex",margin:"20px"}},o.a.createElement("div",null,o.a.createElement("img",{style:{height:"20px",padding:"4px"},src:b.a})),o.a.createElement("div",{style:{marginLeft:"16px",fontSize:"20px",lineHeight:"20px",padding:"4px"}},"Alerts")))}},y=(n(255),n(259),A.scopes),k=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,x={auth:{clientId:A.clientId,redirectUri:k,authority:"https://login.microsoftonline.com/common",storeAuthStateInCookie:!0}};new d.b(x).handleRedirectCallback((function(e,t){}));var E={authProvider:new v(new d.b(x),new h.MSALAuthenticationProviderOptions(y))};function G(){return m.a.initWithMiddleware(E)}function j(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,r){var o,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=G(),t.prev=1,t.next=4,o.api(e).get();case 4:return i=t.sent,t.abrupt("return",n(i));case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",r(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}())}var S={me:function(){return j("/me")},myExtentions:function(e){return j("/me/extensions/".concat(e))},getAlerts:function(){return j("/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields")},setExtention:function(e){return function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,o){var i,a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=G(),n.prev=1,n.next=5,i.api(e).post(t);case 5:return a=n.sent,n.abrupt("return",r(a));case 10:return n.prev=10,n.t0=n.catch(1),n.abrupt("return",o(n.t0));case 14:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e,t){return n.apply(this,arguments)}}())}("/me/extensions/".concat(e.id),e)},updateExtention:function(e){return function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,o){var i,a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=G(),n.prev=1,n.next=4,i.api(e).patch(t);case 4:return a=n.sent,n.abrupt("return",r(a));case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",o(n.t0));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e,t){return n.apply(this,arguments)}}())}("/me/extensions/".concat(e.id),e)}},M=n(223);var O={getAccessToken:function(e){var t=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname;console.log("login replyUrl",t);var n={auth:{clientId:A.clientId,redirectUri:t,authority:"https://login.microsoftonline.com/common"}},r=new d.b(n);return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,o){var i,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={scopes:e},r.handleRedirectCallback((function(e,t){})),r.getAccount()||r.loginRedirect(i),t.prev=3,t.next=6,r.acquireTokenSilent(i);case 6:a=t.sent,n(a.accessToken),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),o(t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},C=n(213),Y=n.n(C),U=n(491),I=n(11),D=n(493);n(470);Object(M.a)();var R=function(){function e(){var t=this;Object(p.a)(this,e),this.tools=function(){return new Promise((function(e,t){e([])}))},this.setNotificationCount=function(e,n){var r=window.self!==window.top?window.top:window.self;r&&r.postMessage({action:"setNotificationCount",count:n,tileId:e,key:t._key},t._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(f.a)(e,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),e}();R.init=function(){return new R};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(471);a.a.render(o.a.createElement((function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],i=t[1],a=Object(r.useState)({}),c=Object(l.a)(a,2),p=(c[0],c[1],Object(r.useState)([])),f=Object(l.a)(p,2),m=f[0],h=f[1],g=Object(r.useState)({}),v=Object(l.a)(g,2),w=v[0],b=v[1],y=Object(r.useState)([]),k=Object(l.a)(y,2),x=k[0],E=k[1],G=Object(r.useState)({}),j=Object(l.a)(G,2),M=j[0],C=j[1],P=function(){try{return window.self!==window.top}catch(e){return!0}}(),z=Object(r.useState)(""),H=Object(l.a)(z,2),N=(H[0],H[1]),T=function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)-1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),R.init().setNotificationCount(3,t)};function B(){return(B=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:new Promise((function(e,t){try{var n=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,r={auth:{clientId:A.clientId,redirectUri:n}},o=new d.b(r);o.handleRedirectCallback((function(e,t){}));var i={user:o.getAccount()};i.user||o.loginRedirect({scopes:["user.read"]}),e(i.user)}catch(a){t(a)}})).then(function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.prev=1,e.next=4,O.getAccessToken(["User.Read.All"]);case 4:return n=e.sent,N(n),e.next=9,Y.a.get(n,"https://graph.microsoft.com/v1.0/me");case 9:r=e.sent,b(r),e.next=25;break;case 14:e.prev=14,e.t0=e.catch(1),e.t1=e.t0.errorCode,e.next="user_login_error"===e.t1?19:21;break;case 19:case 21:return e.abrupt("break",23);case 23:m.push({context:" OfficeGraph.auth.getAccessToken()",error:e.t0}),h(m);case 25:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){m.push({context:"useEffect().auth() ",error:e}),h(m)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){R.init();var e=localStorage.getItem("ztickyBarNotificationCount");e&&parseInt(e);!function(){B.apply(this,arguments)}(),n&&(S.myExtentions("intranets_seenAlerts").then((function(e){try{C(e),function(e){e.etag++,S.updateExtention(e).then((function(){C(e)})).catch((function(e){m.push({context:"OfficeGraph.updateExtention() ",error:e}),h(m)}))}(e),q(M)}catch(t){m.push({context:"Post init",error:t}),h(m),q(null)}})).catch((function(e){m.push({context:"OfficeGraph.myExtentions('intranets_seenAlerts') ",error:e}),h(m)})),q())}),[n]),o.a.createElement("div",{style:{position:"relative",height:"95vh"}},!P&&A.components&&A.components.header&&A.components.header,m.length>0&&o.a.createElement(U.a,{messageBarType:I.a.error,isMultiline:!1,onDismiss:function(){h(m.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(m[0])),o.a.createElement("div",{style:{backgroundColor:"#eeeeee"}},o.a.createElement("div",{style:{padding:"20px",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px",backgroundColor:"#ffffff",height:"80vh"}},!n&&o.a.createElement("div",{style:{textAlign:"center",marginTop:"30vh"}},o.a.createElement(D.a,{text:"Sign in",onClick:function(){alert("Not implemented")}})),x.map((function(e,t){return o.a.createElement("div",{className:"alert"},o.a.createElement("div",{style:{display:"flex",cursor:e.url?"pointer":"default"},onClick:function(){T(),e.url&&window.open(e.url,"_blank")}},o.a.createElement("div",null,o.a.createElement("img",{style:{width:"80px",padding:"10px"},src:e.image?e.image:"https://www.huntersglenvet.com/wp-content/uploads/2018/03/xpop-up-alert.png.pagespeed.ic_.vwzzZnK_Rf-288x300.png"})),o.a.createElement("div",{style:{position:"relative",flexGrow:1}},o.a.createElement("div",{style:{fontSize:"24px",padding:"10px"}},e.title),o.a.createElement("div",{style:{fontSize:"12px",padding:"10px"}},e.message),o.a.createElement("div",{style:{fontSize:"12px",position:"absolute",bottom:0,padding:"10px"}},"Last updated: ",e.date)),o.a.createElement("div",null)))})))),!P&&o.a.createElement("div",{style:{position:"absolute",bottom:0}},o.a.createElement("button",{onClick:function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)+1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),R.init().setNotificationCount(3,t)}},"+"),o.a.createElement("button",{onClick:T},"-"),w&&o.a.createElement("div",null,w.displayName," (",w.userPrincipalName,")"),A.alertsUrl&&o.a.createElement("a",{href:A.alertsUrl,target:"_blank"},A.alertsUrl)));function q(e){S.getAlerts().then((function(t){var n={};if(t.value){var r=t.value.map((function(e){try{var t={id:e.fields.id,title:e.fields.Title,active:e.fields.Active,date:e.fields.Date,message:e.fields.Message,image:e.fields.RollupImage?e.fields.RollupImage.Url:null,url:e.fields.Url?e.fields.Url.Url:null};return n[e.fields.id]=t,t}catch(r){}})),o=[];e&&e.forEach((function(e){n[e.id]&&o.push({id:e.id,url:n[e.id].url})})),R.init().setNotificationCount(3,r.length),E(r)}})).catch((function(e){m.push({context:"OfficeGraph.getAlerts() ",error:e}),h(m)}))}}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[229,1,2]]]);
//# sourceMappingURL=main.aa458a43.chunk.js.map