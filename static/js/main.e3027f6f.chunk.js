(this["webpackJsonpztickybar-notifier"]=this["webpackJsonpztickybar-notifier"]||[]).push([[0],{128:function(e,t){e.exports="data:image/png;base64,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"},207:function(e){e.exports=JSON.parse('{"name":"ztickybar-notifier","version":"0.1.6","private":true,"dependencies":{"@microsoft/microsoft-graph-client":"^2.0.0","@uifabric/fluent-theme":"^7.1.4","animejs":"^3.1.0","axios":"^0.19.0","dexie":"^2.0.4","dexie-observable":"^1.0.0-beta.5","dexie-syncable":"^1.0.0-beta.4","exceljs":"^3.5.0","https":"^1.0.0","into-stream":"5.1.1","lodash":"^4.17.15","mammoth":"^1.4.9","moment":"^2.24.0","msal":"^1.2.1","office-ui-fabric-core":"^11.0.0","office-ui-fabric-react":"^7.61.1","quill-delta-to-html":"^0.11.0","react":"^16.12.0","react-dom":"^16.12.0","react-dropzone":"^10.2.1","react-grid-layout":"^0.17.1","react-resizable":"^1.10.1","react-scripts":"3.2.0","string-to-stream":"^3.0.1","xlsx":"^0.15.4","format-json":"^1.0.3"},"devDependencies":{"gh-pages":"^2.1.1"},"scripts":{"start":"PORT=3002 react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","config-default":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js","config-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js","config-intrateam":"cp src/config/intrateam/index.html public/index.html && cp src/config/intrateam.js src/config/index.js","deploy":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js && react-scripts build && gh-pages -b master -d build -r https://github.com/ztickybar/alarms","deploy-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js && react-scripts build && echo alerts.nets-intranets.com > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/nets-intranets/notify","deploy-intrateam":"cp src/config/intrateam/index.html public/index.html && cp src/config/intrateam.js src/config/index.js && react-scripts build && echo intrateam-alerts.zbar.app > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/zbar-intrateam/alerts"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},222:function(e,t,n){e.exports=n(456)},227:function(e,t,n){},245:function(e,t){},247:function(e,t){},279:function(e,t){},280:function(e,t){},345:function(e,t){},438:function(e,t,n){},455:function(e,t){},456:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=n(57),o=n.n(a),c=(n(227),n(29)),s=n.n(c),l=n(49),u=n(30),p=n(205),f=n(206),d=(n(229),n(128)),m=n.n(d),g={clientId:"3befe8c6-843e-4f4f-8b5b-b8e37174b961",scopes:["user.readwrite","Sites.Read.All"],title:"Alerts",logo:m.a,isAnomyous:!0,rss:"https://netszbar.blob.core.windows.net/webflow/redirects.json",alertsBlob:"https://netszbar.blob.core.windows.net/sharepoint/alerts.json?sp=r&st=2020-03-10T10:28:46Z&se=2099-03-10T18:28:46Z&spr=https&sv=2019-02-02&sr=b&sig=pDkl%2F81unoTyGfMaMSs%2FMfLZ9Eq9uVN9AvQeVjhLfsc%3D",extensionName:"intranets_seenAlerts",currentAlerts:"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields",alertsUrl:"https://christianiabpos.sharepoint.com/sites/intranets-corp/lists/currentAlerts",components:{header:i.a.createElement("div",{style:{borderBottom:"1px solid #cccccc"}},i.a.createElement("div",{style:{display:"flex",margin:"20px"}},i.a.createElement("div",null,i.a.createElement("a",{href:"https://nets-intranets.com"},i.a.createElement("img",{style:{height:"20px",padding:"4px"},src:m.a}))),i.a.createElement("div",{style:{marginLeft:"16px",fontSize:"20px",lineHeight:"20px",padding:"4px"}},"Alerts")))}},h=n(217),v=n(216),w=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,x={auth:{clientId:g.clientId,redirectUri:w,storeAuthStateInCookie:!0,authority:"https://login.microsoftonline.com/common"}},b=new v.a(x);var A={getAccessToken:function(e){return new Promise(function(){var t=Object(l.a)(s.a.mark((function t(n,r){var i,a,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={scopes:e},b.handleRedirectCallback((function(e,t){})),t.prev=2,t.next=5,b.acquireTokenSilent(i);case 5:a=t.sent,n(a.accessToken),t.next=19;break;case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",n(null));case 15:return b.getAccount()||b.getLoginInProgress()||((o=sessionStorage.getItem("loops")?parseInt(sessionStorage.getItem("loops")):0)>3&&(sessionStorage.setItem("loops",0),sessionStorage.clear(),window.location.reload()),sessionStorage.setItem("loops",o+1),b.loginRedirect(i)),t.abrupt("break",18);case 17:return t.abrupt("break",18);case 18:r(t.t0);case 19:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e,n){return t.apply(this,arguments)}}())},login:function(e){var t={scopes:e};b.loginRedirect(t)}},y=n(50),E=n.n(y),j=n(129),k=n.n(j),G=n(476),S=n(8),O=n(215),C=n(475),Y=(n(438),n(207)),N=n(130),I=n.n(N);Object(h.a)();var M=function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var r=n[1].split("&"),i=0;i<r.length;i++){var a=r[i].split("=");t[a[0]]=decodeURIComponent(a[1])}return t}(window.location.href);var z=function(){function e(){var t=this;Object(p.a)(this,e),this.tools=function(){return new Promise((function(e,t){e([])}))},this.setNotificationCount=function(e,n){(isNaN(n)||n<0)&&(n=0);var r=window.self!==window.top?window.top:window.self;r&&r.postMessage({action:"setNotificationCount",count:n,tileId:e,key:t._key},t._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(f.a)(e,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),e}();z.init=function(){return new z};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(455);o.a.render(i.a.createElement((function(){var e=["User.ReadWrite","Sites.Read.All"],t="seenalerts",n=Object(r.useState)(!0),a=Object(u.a)(n,2),o=(a[0],a[1],Object(r.useState)([])),c=Object(u.a)(o,2),p=c[0],f=c[1],d=Object(r.useState)({}),m=Object(u.a)(d,2),h=m[0],v=m[1],w=Object(r.useState)([]),x=Object(u.a)(w,2),b=x[0],y=x[1],j=Object(r.useState)([]),N=Object(u.a)(j,2),U=N[0],B=N[1],H=function(){try{return window.self!==window.top}catch(e){return!0}}(),T=Object(r.useState)(""),D=Object(u.a)(T,2),R=D[0],P=D[1],V=Object(r.useState)(0),L=Object(u.a)(V,2),F=L[0],J=L[1],Q=Object(r.useState)(!1),K=Object(u.a)(Q,2),X=K[0],Z=K[1],q=Object(r.useState)(!1),W=Object(u.a)(q,2),_=W[0],$=W[1],ee=Object(r.useState)(0),te=Object(u.a)(ee,2),ne=te[0],re=te[1],ie=Object(r.useState)(!1),ae=Object(u.a)(ie,2),oe=ae[0],ce=ae[1],se=function(e){re(e),z.init().setNotificationCount(3,e)};function le(){return(le=Object(l.a)(s.a.mark((function t(){var n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!g.isAnomyous){t.next=4;break}return g.alertsBlob?pe([]):de([]),t.abrupt("return");case 4:return t.next=6,A.getAccessToken(e).catch((function(e){}));case 6:if(n=t.sent){t.next=9;break}return t.abrupt("return",ce(!0));case 9:return P(n),t.next=12,E.a.get(n,"https://graph.microsoft.com/v1.0/me");case 12:r=t.sent,v(r),t.next=26;break;case 16:t.prev=16,t.t0=t.catch(0),t.t1=t.t0.errorCode,t.next="user_login_error"===t.t1?22:23;break;case 22:case 23:return t.abrupt("break",24);case 24:p.push({context:" OfficeGraph.auth.getAccessToken()",error:t.t0}),f(p);case 26:case"end":return t.stop()}}),t,null,[[0,16]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){z.init();var e=localStorage.getItem("ztickyBarNotificationCount");e&&parseInt(e);!function(){le.apply(this,arguments)}(),R&&E.a.get(R,"https://graph.microsoft.com/v1.0/me/extensions/".concat(g.extensionName)).then((function(e){try{ue(e.seenAlerts)}catch(t){p.push({context:"Post init",error:t}),f(p),ue(null)}})).catch((function(e){p.push({context:"OfficeGraph.myExtentions() ",error:e}),f(p)}))}),[R,F]),i.a.createElement("div",{style:{position:"relative",height:"95vh"}},!H&&g.components&&g.components.header&&g.components.header,p.length>0&&i.a.createElement(G.a,{messageBarType:S.a.error,isMultiline:!1,onDismiss:function(){f(p.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(p[0])),i.a.createElement("div",{style:{backgroundColor:"#eeeeee"}},i.a.createElement("div",{style:{padding:"20px",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px",backgroundColor:"#ffffff",height:"80vh"}},oe&&i.a.createElement("div",{style:{textAlign:"center",marginTop:"30vh"}},i.a.createElement(O.a,{text:"Sign in",onClick:function(){A.login()}})),function(){if(_&&0===b.length)return i.a.createElement("div",null,"No alerts");return b.map((function(e,t){return i.a.createElement("div",{className:"alert"},i.a.createElement("div",{style:{fontWeight:e.read?300:600,display:"flex",cursor:X?"wait":"pointer"},onClick:function(){X||e.read||(Z(!0),U.push({id:e.id,url:e.url,date:k.a.utc()}),ge(U).then((function(){Z(!1),pe()})).catch((function(){Z(!1)})))}},i.a.createElement("div",{style:{position:"relative",flexGrow:1}},i.a.createElement("div",{style:{fontSize:"24px",padding:"10px"}},e.title),i.a.createElement("div",{style:{fontSize:"12px",padding:"10px"}},e.message),i.a.createElement("div",{style:{fontSize:"12px",padding:"10px"}},"Last updated: ",k()(e.date).format("LLLL")))))}))}())),!H&&M.debug&&i.a.createElement("div",{style:{position:"absolute",bottom:0}},i.a.createElement("div",{style:{display:"flex",width:"100vw"}},i.a.createElement("div",{style:{flexGrow:1,padding:8}},h&&i.a.createElement("div",null,h.displayName," (",h.userPrincipalName,")"),g.alertsUrl&&i.a.createElement("a",{href:g.alertsUrl,target:"_blank"},g.alertsUrl),i.a.createElement("div",null,i.a.createElement("button",{onClick:function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)+1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),z.init().setNotificationCount(3,t)}},"+"),i.a.createElement("button",{onClick:function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)-1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),z.init().setNotificationCount(3,t)}},"-"))),i.a.createElement("div",{style:{flexGrow:1}},i.a.createElement("div",null,"Unread: ",ne),i.a.createElement("div",null,i.a.createElement(C.a,{text:"clear",onClick:function(){B([]),ge([])}})," ",i.a.createElement(C.a,{text:"clear session",onClick:function(){sessionStorage.clear(),window.location.reload()}})),JSON.stringify(U)),i.a.createElement("div",{style:{padding:8,textAlign:"right"}},i.a.createElement("div",null,i.a.createElement("a",{href:"https://www.jumpto365.com",target:"_blank"},"Zticky Bar Notifier")),i.a.createElement("div",null,"Version ",Y.version)))));function ue(e){E.a.get(R,g.currentAlerts).then((function(t){var n={};if(t){var r=t.map((function(e){try{var t={id:e.fields.id,title:e.fields.Title,active:e.fields.Active,date:e.fields.Date,message:e.fields.Message,image:e.fields.RollupImage?e.fields.RollupImage.Url:null,url:e.fields.Url?e.fields.Url.Url:null};return n[e.fields.id]=t,t}catch(r){p.push({context:"OfficeGraph.getAlerts() map ",error:r}),f(p)}})),i=[];e&&e.forEach((function(e){n[e.id]&&(n[e.id].read=!0,i.push({id:e.id,url:n[e.id].url}))}));var a=r.length-e.length,o=z.init();se(a),window.document.title=a>0?g.title+" ("+a+" unread)":g.title,o.setNotificationCount(3,a),y(r),$(!0),B(e)}})).catch((function(e){p.push({context:"OfficeGraph.getAlerts() ",error:e}),f(p)}))}function pe(){return fe.apply(this,arguments)}function fe(){return(fe=Object(l.a)(s.a.mark((function e(){var n,r,i,a,o,c,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem(t),r=n?JSON.parse(n):[],i={},e.prev=3,e.next=6,I.a.get(g.alertsBlob+"&bypasscache="+Date.now());case 6:a=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),p.push({context:" OfficeGraph.auth.getAccessToken()",error:e.t0}),f(p);case 13:o=a.data.alerts.map((function(e){try{var t={id:e.id,read:!1,title:e.title,active:!0,date:e.date,message:e.message,priority:e.priority,url:e.url};return i[e.id]=e,t}catch(n){p.push({context:"OfficeGraph.getAlerts() map ",error:n}),f(p)}})),c=[],r&&r.forEach((function(e){if(i[e.id]){i[e.id].read=!0;for(var t=0;t<o.length;t++){o[t].id===e.id&&(o[t].read=!0)}c.push({id:e.id,url:i[e.id].url})}})),l=o.length-r.length,u=z.init(),se(l),window.document.title=l>0?g.title+" ("+l+" unread)":g.title,u.setNotificationCount(3,l),y(o),$(!0),B(r);case 25:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function de(){return me.apply(this,arguments)}function me(){return(me=Object(l.a)(s.a.mark((function e(){var n,r,i,a,o,c,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem(t),r=n?JSON.parse(n):[],i={},e.prev=3,e.next=6,I.a.get(g.rss);case 6:a=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),p.push({context:" OfficeGraph.auth.getAccessToken()",error:e.t0}),f(p);case 13:o=a.data.rss.channel.item.map((function(e){try{var t=e["media:content"],n=t||null,r=n?n["-url"]:null,a={id:e.guid,read:!1,title:e.title,active:!0,date:e.pubDate,message:e.description,image:r,url:e.link};return i[e.guid]=a,a}catch(o){p.push({context:"OfficeGraph.getAlerts() map ",error:o}),f(p)}})),c=[],r&&r.forEach((function(e){i[e.id]&&(i[e.id].read=!0,c.push({id:e.id,url:i[e.id].url}))})),l=o.length-r.length,u=z.init(),se(l),window.document.title=l>0?g.title+" ("+l+" unread)":g.title,u.setNotificationCount(3,l),y(o),$(!0),B(r),J(F+1);case 25:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function ge(e){if(g.isAnomyous){var n=JSON.stringify(e);return localStorage.setItem(t,n),new Promise((function(e,t){e()}))}return new Promise(function(){var t=Object(l.a)(s.a.mark((function t(n,r){var i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.a.get(R,"https://graph.microsoft.com/v1.0/me/extensions/".concat(g.extensionName));case 2:i=t.sent,(i?E.a.patch(R,"https://graph.microsoft.com/v1.0/me/extensions/".concat(g.extensionName),{"@odata.type":"#microsoft.graph.openTypeExtension",extensionName:g.extensionName,seenAlerts:e,etag:i.etag+1,id:g.extensionName}):E.a.post(R,"https://graph.microsoft.com/v1.0/me/extensions",{"@odata.type":"#microsoft.graph.openTypeExtension",extensionName:g.extensionName,seenAlerts:e,etag:1,id:g.extensionName})).then((function(e){try{J(F+1),n()}catch(t){p.push({context:"Post init",error:t}),f(p),ue(null),n()}})).catch((function(e){p.push({context:"setSeenAlerts ",error:e}),f(p),n()}));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},50:function(e,t,n){var r=n(230),i={},a={tokenEndpoint:"https://login.microsoftonline.com/common/oauth2/token"};i.getAccessToken=function(){if(window)throw"Not valid client side";return new Promise((function(e,t){var n={grant_type:"client_credentials",client_id:a.clientId,client_secret:a.clientSecret,resource:"https://graph.microsoft.com"};r.post({url:a.tokenEndpoint,form:n},(function(n,r,i){var a=JSON.parse(i);n?t(n):a.error?t(a.error_description):e(a.access_token)}))}))},e.exports.getRaw=function(e,t){return console.log("getting",t),new Promise((function(n,i){r.get({url:t,headers:{authorization:"Bearer "+e}},(function(e,t,r){if(e)return n({hasError:!0,error:e});n({hasError:!1,result:r})}))}))},e.exports.get=function(e,t){return new Promise((function(n,i){!function e(t,n,i,a,o,c){console.log("getting",n,!0===a),r.get({url:n,headers:{"content-type":"application/json",authorization:"Bearer "+t}},(function(r,s,l){var u,p;if(r){var f=c?c+1:1;return f>3?i(r,null,o):(console.log("retry #",f),e(t,n,i,a,o,f))}return(u=JSON.parse(l)).error?i(u.error,null,o):u["@odata.nextLink"]?(p=a?a.concat(u.value):u.value,e(t,u["@odata.nextLink"],i,p,o)):void(a?i(null,a.concat(u.value),o):u.value?i(null,u.value,o):i(null,u,o))}))}(e,t,(function(e,t){if(e)return i(e);n(t)}))}))},e.exports.post=function(e,t,n){return new Promise((function(i,a){!function(e,t,n,i){r.post({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var r;return e?i(e):(r=""===n?{}:JSON.parse(n)).error?i(r.error):void i(null,r)}))}(e,t,n,(function(e,t){if(e)return a(e);i(t)}))}))},e.exports.patch=function(e,t,n){return new Promise((function(i,a){!function(e,t,n,i){r.patch({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var r;return e?i(e):(r=""===n?{}:JSON.parse(n)).error?i(r.error):void i(null,r)}))}(e,t,n,(function(e,t){if(e)return a(e);i(t)}))}))},e.exports.auth=i}},[[222,1,2]]]);
//# sourceMappingURL=main.e3027f6f.chunk.js.map