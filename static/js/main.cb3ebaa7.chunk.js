(this["webpackJsonpztickybar-alarms"]=this["webpackJsonpztickybar-alarms"]||[]).push([[0],{108:function(e,t){},109:function(e,t){},115:function(e,t){},117:function(e,t){},122:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i),a=n(26),c=n.n(a),o=(n(84),n(29)),s=n(3),u=n(6),l=(n(46),n(2)),p=n.n(l),f=n(27),d=n(22),m=n(74),g=n(69);function h(){try{return window.self!==window.top}catch(e){return!0}}var w=function(){function e(t,n){Object(s.a)(this,e),this.options=n,this.msalApplication=t}return Object(u.a)(e,[{key:"getAccessToken",value:function(e){var t=this,n=this;return new Promise(function(){var i=Object(f.a)(p.a.mark((function i(r,a){var c,o,s,u,l,f,m,g;return p.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("undefined"!==typeof(c=e)&&(o=c.scopes),"undefined"!==typeof o&&0!==o.length||(o=t.options.scopes),0!==o.length){i.next=8;break}throw(s=new Error).name="EmptyScopes",s.message="Scopes cannot be empty, Please provide a scopes",s;case 8:if(n.msalApplication.handleRedirectCallback((function(e,t){if(e)return a(e)})),!t.msalApplication.getAccount()){i.next=42;break}return u={scopes:o},i.prev=11,i.next=14,t.msalApplication.acquireTokenSilent(u);case 14:l=i.sent,r(l.accessToken),i.next=40;break;case 18:if(i.prev=18,i.t0=i.catch(11),!(i.t0 instanceof d.a)){i.next=38;break}if(i.prev=21,!h()){i.next=29;break}return i.next=25,t.msalApplication.acquireTokenPopup(u);case 25:f=i.sent,r(f.accessToken),i.next=30;break;case 29:case 30:i.next=36;break;case 32:i.prev=32,i.t1=i.catch(21),a(i.t1);case 36:i.next=40;break;case 38:a(i.t0);case 40:i.next=60;break;case 42:if(i.prev=42,m={scopes:o},!h()){i.next=53;break}return i.next=47,t.msalApplication.loginPopup(m);case 47:return i.next=49,t.msalApplication.acquireTokenSilent(m);case 49:g=i.sent,r(g.accessToken),i.next=55;break;case 53:return n.msalApplication.loginRedirect(m),i.abrupt("return");case 55:i.next=60;break;case 57:i.prev=57,i.t2=i.catch(42),a(i.t2);case 60:case"end":return i.stop()}}),i,null,[[11,18],[21,32],[42,57]])})));return function(e,t){return i.apply(this,arguments)}}())}}]),e}(),A=(n(89),n(42)),v=n.n(A),x={clientId:"3befe8c6-843e-4f4f-8b5b-b8e37174b961",scopes:["user.readwrite","Sites.Read.All"],title:"Alerts",logo:v.a,currentAlerts:"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields",components:{header:r.a.createElement("div",{style:{borderBottom:"1px solid #cccccc"}},r.a.createElement("div",{style:{display:"flex",margin:"20px"}},r.a.createElement("div",null,r.a.createElement("img",{style:{height:"20px",padding:"4px"},src:v.a})),r.a.createElement("div",{style:{marginLeft:"16px",fontSize:"20px",lineHeight:"20px",padding:"4px"}},"Alerts")))}},E=(n(106),n(110),x.scopes),k=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,b={auth:{clientId:x.clientId,redirectUri:k,authority:"https://login.microsoftonline.com/common",storeAuthStateInCookie:!0}};new d.b(b).handleRedirectCallback((function(e,t){}));var y={authProvider:new w(new d.b(b),new g.MSALAuthenticationProviderOptions(E))};function G(){return m.a.initWithMiddleware(y)}function j(e){return new Promise(function(){var t=Object(f.a)(p.a.mark((function t(n,i){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=G(),t.prev=1,t.next=4,r.api(e).get();case 4:return a=t.sent,t.abrupt("return",n(a));case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",i(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}())}var Y={me:function(){return j("/me")},myExtentions:function(e){return j("/me/extensions/".concat(e))},getAlerts:function(){return j("/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields")},setExtention:function(e){return function(e,t){return new Promise(function(){var n=Object(f.a)(p.a.mark((function n(i,r){var a,c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=G(),n.prev=1,n.next=5,a.api(e).post(t);case 5:return c=n.sent,n.abrupt("return",i(c));case 10:return n.prev=10,n.t0=n.catch(1),n.abrupt("return",r(n.t0));case 14:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e,t){return n.apply(this,arguments)}}())}("/me/extensions/".concat(e.id),e)},updateExtention:function(e){return function(e,t){return new Promise(function(){var n=Object(f.a)(p.a.mark((function n(i,r){var a,c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=G(),n.prev=1,n.next=4,a.api(e).patch(t);case 4:return c=n.sent,n.abrupt("return",i(c));case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",r(n.t0));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e,t){return n.apply(this,arguments)}}())}("/me/extensions/".concat(e.id),e)}},M=n(75),C=n(138),H=n(7);Object(M.a)(),localStorage.clear();var S=function(){function e(){var t=this;Object(s.a)(this,e),this.tools=function(){return new Promise((function(e,t){e([])}))},this.setNotificationCount=function(e,n){var i=window.self!==window.top?window.top:window.self;i&&i.postMessage({action:"setNotificationCount",count:n,tileId:e,key:t._key},t._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(u.a)(e,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),e}();S.init=function(){return new S};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement((function(){var e=Object(i.useState)(!0),t=Object(o.a)(e,2),n=t[0],a=(t[1],Object(i.useState)([])),c=Object(o.a)(a,2),s=c[0],u=c[1],l=Object(i.useState)({}),p=Object(o.a)(l,2),f=(p[0],p[1]),d=Object(i.useState)([]),m=Object(o.a)(d,2),g=m[0],h=m[1],w=Object(i.useState)({}),A=Object(o.a)(w,2),v=A[0],E=A[1],k=function(){try{return window.self!==window.top}catch(e){return!0}}(),b=function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)-1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),S.init().setNotificationCount(3,t)};return Object(i.useEffect)((function(){S.init();var e=localStorage.getItem("ztickyBarNotificationCount");e&&parseInt(e);n&&(Y.myExtentions("intranets_seenAlerts").then((function(e){try{f(e),E(e),function(e){e.etag++,Y.updateExtention(e).then((function(){E(e)})).catch((function(e){s.push({context:"OfficeGraph.updateExtention() ",error:e}),u(s)}))}(e),y(v)}catch(t){s.push({context:"Post init",error:t}),u(s),y(null)}})).catch((function(e){s.push({context:"OfficeGraph.myExtentions('intranets_seenAlerts') ",error:e}),u(s)})),y())}),[n]),r.a.createElement("div",{style:{position:"relative",height:"95vh"}},!k&&x.components&&x.components.header&&x.components.header,s.length>0&&r.a.createElement(C.a,{messageBarType:H.a.error,isMultiline:!1,onDismiss:function(){u(s.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(s[0])),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},g.map((function(e,t){return r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",cursor:e.url?"pointer":"default"},onClick:function(){b(),e.url&&window.open(e.url,"_blank")}},r.a.createElement("div",null,r.a.createElement("img",{style:{width:"80px",padding:"10px"},src:e.image?e.image:"https://www.huntersglenvet.com/wp-content/uploads/2018/03/xpop-up-alert.png.pagespeed.ic_.vwzzZnK_Rf-288x300.png"})),r.a.createElement("div",{style:{position:"relative",flexGrow:1}},r.a.createElement("div",{style:{fontSize:"24px",padding:"10px"}},e.title),r.a.createElement("div",{style:{fontSize:"12px",padding:"10px"}},e.message),r.a.createElement("div",{style:{fontSize:"12px",position:"absolute",bottom:0,padding:"10px"}},"Last updated: ",e.date)),r.a.createElement("div",null)))}))),r.a.createElement("div",{style:{position:"absolute",bottom:0}},r.a.createElement("button",{onClick:function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)+1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),S.init().setNotificationCount(3,t)}},"+"),r.a.createElement("button",{onClick:b},"-")));function y(e){Y.getAlerts().then((function(t){var n={};if(t.value){var i=t.value.map((function(e){try{var t={id:e.fields.id,title:e.fields.Title,active:e.fields.Active,date:e.fields.Date,message:e.fields.Message,image:e.fields.RollupImage?e.fields.RollupImage.Url:null,url:e.fields.Url?e.fields.Url.Url:null};return n[e.fields.id]=t,t}catch(i){}})),r=[];e&&e.forEach((function(e){n[e.id]&&r.push({id:e.id,url:n[e.id].url})})),S.init().setNotificationCount(3,i.length),h(i)}})).catch((function(e){s.push({context:"OfficeGraph.getAlerts() ",error:e}),u(s)}))}}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},42:function(e,t){e.exports="data:image/png;base64,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"},59:function(e,t){},79:function(e,t,n){e.exports=n(122)},84:function(e,t,n){}},[[79,1,2]]]);
//# sourceMappingURL=main.cb3ebaa7.chunk.js.map