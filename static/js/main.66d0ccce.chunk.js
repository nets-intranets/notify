(this["webpackJsonpztickybar-alarms"]=this["webpackJsonpztickybar-alarms"]||[]).push([[0],{107:function(t,e){},108:function(t,e){},114:function(t,e){},116:function(t,e){},121:function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r),a=n(26),o=n.n(a),c=(n(83),n(29)),s=n(3),u=n(6),l=(n(45),n(2)),p=n.n(l),f=n(27),d=n(22),m=n(73),h=n(68);function w(){try{return window.self!==window.top}catch(t){return!0}}var v=function(){function t(e,n){Object(s.a)(this,t),this.options=n,this.msalApplication=e}return Object(u.a)(t,[{key:"getAccessToken",value:function(t){var e=this,n=this;return new Promise(function(){var r=Object(f.a)(p.a.mark((function r(i,a){var o,c,s,u,l,f,m,h;return p.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("undefined"!==typeof(o=t)&&(c=o.scopes),"undefined"!==typeof c&&0!==c.length||(c=e.options.scopes),0!==c.length){r.next=8;break}throw(s=new Error).name="EmptyScopes",s.message="Scopes cannot be empty, Please provide a scopes",s;case 8:if(n.msalApplication.handleRedirectCallback((function(t,e){if(t)return a(t)})),!e.msalApplication.getAccount()){r.next=42;break}return u={scopes:c},r.prev=11,r.next=14,e.msalApplication.acquireTokenSilent(u);case 14:l=r.sent,i(l.accessToken),r.next=40;break;case 18:if(r.prev=18,r.t0=r.catch(11),!(r.t0 instanceof d.a)){r.next=38;break}if(r.prev=21,!w()){r.next=29;break}return r.next=25,e.msalApplication.acquireTokenPopup(u);case 25:f=r.sent,i(f.accessToken),r.next=30;break;case 29:case 30:r.next=36;break;case 32:r.prev=32,r.t1=r.catch(21),a(r.t1);case 36:r.next=40;break;case 38:a(r.t0);case 40:r.next=60;break;case 42:if(r.prev=42,m={scopes:c},!w()){r.next=53;break}return r.next=47,e.msalApplication.loginPopup(m);case 47:return r.next=49,e.msalApplication.acquireTokenSilent(m);case 49:h=r.sent,i(h.accessToken),r.next=55;break;case 53:return n.msalApplication.loginRedirect(m),r.abrupt("return");case 55:r.next=60;break;case 57:r.prev=57,r.t2=r.catch(42),a(r.t2);case 60:case"end":return r.stop()}}),r,null,[[11,18],[21,32],[42,57]])})));return function(t,e){return r.apply(this,arguments)}}())}}]),t}(),b=(n(88),{clientId:"3befe8c6-843e-4f4f-8b5b-b8e37174b961",scopes:["user.readwrite","Sites.Read.All"],title:"IntraNets Notifier",currentAlerts:"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields"}),g=(n(105),n(109),b.scopes),x=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,k={auth:{clientId:b.clientId,redirectUri:x,authority:"https://login.microsoftonline.com/common",storeAuthStateInCookie:!0}};new d.b(k).handleRedirectCallback((function(t,e){}));var y={authProvider:new v(new d.b(k),new h.MSALAuthenticationProviderOptions(g))};function O(){return m.a.initWithMiddleware(y)}function E(t){return new Promise(function(){var e=Object(f.a)(p.a.mark((function e(n,r){var i,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=O(),e.prev=1,e.next=4,i.api(t).get();case 4:return a=e.sent,e.abrupt("return",n(a));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}())}var A={me:function(){return E("/me")},myExtentions:function(t){return E("/me/extensions/".concat(t))},getAlerts:function(){return E("/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields")},setExtention:function(t){return function(t,e){return new Promise(function(){var n=Object(f.a)(p.a.mark((function n(r,i){var a,o;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=O(),n.prev=1,n.next=5,a.api(t).post(e);case 5:return o=n.sent,n.abrupt("return",r(o));case 10:return n.prev=10,n.t0=n.catch(1),n.abrupt("return",i(n.t0));case 14:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(t,e){return n.apply(this,arguments)}}())}("/me/extensions/".concat(t.id),t)},updateExtention:function(t){return function(t,e){return new Promise(function(){var n=Object(f.a)(p.a.mark((function n(r,i){var a,o;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=O(),n.prev=1,n.next=4,a.api(t).patch(e);case 4:return o=n.sent,n.abrupt("return",r(o));case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",i(n.t0));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(t,e){return n.apply(this,arguments)}}())}("/me/extensions/".concat(t.id),t)}},I=n(74),j=n(137),S=n(7);Object(I.a)();var C=function(){function t(){var e=this;Object(s.a)(this,t),this.tools=function(){return new Promise((function(t,e){t([])}))},this.setNotificationCount=function(t,n){var r=window.self!==window.top?window.top:window.self;r&&r.postMessage({action:"setNotificationCount",count:n,tileId:t,key:e._key},e._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(u.a)(t,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),t}();C.init=function(){return new C};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement((function(){var t=Object(r.useState)(!1),e=Object(c.a)(t,2),n=(e[0],e[1],Object(r.useState)([])),a=Object(c.a)(n,2),o=a[0],s=a[1],u=Object(r.useState)({}),l=Object(c.a)(u,2),p=(l[0],l[1]),f=Object(r.useState)([]),d=Object(c.a)(f,2),m=d[0],h=d[1],w=Object(r.useState)({}),v=Object(c.a)(w,2),g=(v[0],v[1]),x=function(){var t=localStorage.getItem("ztickyBarNotificationCount"),e=t?parseInt(t)>0?parseInt(t)-1:1:0;localStorage.setItem("ztickyBarNotificationCount",e),C.init().setNotificationCount(3,e)};return Object(r.useEffect)((function(){var t=C.init(),e=localStorage.getItem("ztickyBarNotificationCount"),n=e?parseInt(e):0;t.setNotificationCount(3,n),A.myExtentions("intranets_seenAlerts").then((function(t){try{p(t),g(t),function(t){t.etag++,A.updateExtention(t).then((function(){g(t)})).catch((function(t){o.push({context:"OfficeGraph.updateExtention() ",error:t}),s(o)}))}(t),C.init().setNotificationCount(3,2)}catch(e){o.push({context:"Post init",error:e}),s(o)}})).catch((function(t){o.push({context:"OfficeGraph.myExtentions('intranets_seenAlerts') ",error:t}),s(o)})),A.getAlerts().then((function(t){if(t.value){var e=t.value.map((function(t){try{return{id:t.fields.id,title:t.fields.Title,active:t.fields.Active,date:t.fields.Date,message:t.fields.Message,image:t.fields.RollupImage?t.fields.RollupImage.Url:null}}catch(e){}}));h(e)}})).catch((function(t){o.push({context:"OfficeGraph.getAlerts() ",error:t}),s(o)}))}),[]),i.a.createElement("div",null,b.title,o.length>0&&i.a.createElement(j.a,{messageBarType:S.a.error,isMultiline:!1,onDismiss:function(){s(o.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(o[0])),m.map((function(t,e){return i.a.createElement("div",null,i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("div",{onClick:x},i.a.createElement("img",{style:{width:"120px",padding:"10px"},src:t.image?t.image:"https://www.huntersglenvet.com/wp-content/uploads/2018/03/xpop-up-alert.png.pagespeed.ic_.vwzzZnK_Rf-288x300.png"})),i.a.createElement("div",null,i.a.createElement("div",{style:{fontSize:"24px",padding:"10px"}},t.title),i.a.createElement("div",{style:{fontSize:"12px",padding:"10px"}},t.message)),i.a.createElement("div",null)))})),i.a.createElement("hr",null),i.a.createElement("button",{onClick:function(){var t=localStorage.getItem("ztickyBarNotificationCount"),e=t?parseInt(t)>0?parseInt(t)+1:1:0;localStorage.setItem("ztickyBarNotificationCount",e),C.init().setNotificationCount(3,e)}},"+"),i.a.createElement("button",{onClick:x},"-"))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},58:function(t,e){},78:function(t,e,n){t.exports=n(121)},83:function(t,e,n){}},[[78,1,2]]]);
//# sourceMappingURL=main.66d0ccce.chunk.js.map