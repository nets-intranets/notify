(this["webpackJsonpztickybar-alarms"]=this["webpackJsonpztickybar-alarms"]||[]).push([[0],{35:function(t,e){},51:function(t,e,n){t.exports=n(94)},56:function(t,e,n){},80:function(t,e){},81:function(t,e){},87:function(t,e){},89:function(t,e){},94:function(t,e,n){"use strict";n.r(e);var r=n(5),a=n.n(r),i=n(44),o=n.n(i),c=(n(56),n(15)),s=n(2),u=n(3),l=(n(22),n(0)),p=n.n(l),f=n(13),h=n(10),m=n(47),w=n(46);function d(){try{return window.self!==window.top}catch(t){return!0}}var b=function(){function t(e,n){Object(s.a)(this,t),this.options=n,this.msalApplication=e}return Object(u.a)(t,[{key:"getAccessToken",value:function(t){var e=this,n=this;return new Promise(function(){var r=Object(f.a)(p.a.mark((function r(a,i){var o,c,s,u,l,f,m,w;return p.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("undefined"!==typeof(o=t)&&(c=o.scopes),"undefined"!==typeof c&&0!==c.length||(c=e.options.scopes),0!==c.length){r.next=8;break}throw(s=new Error).name="EmptyScopes",s.message="Scopes cannot be empty, Please provide a scopes",s;case 8:if(n.msalApplication.handleRedirectCallback((function(t,e){if(t)return i(t)})),!e.msalApplication.getAccount()){r.next=42;break}return u={scopes:c},r.prev=11,r.next=14,e.msalApplication.acquireTokenSilent(u);case 14:l=r.sent,a(l.accessToken),r.next=40;break;case 18:if(r.prev=18,r.t0=r.catch(11),!(r.t0 instanceof h.a)){r.next=38;break}if(r.prev=21,!d()){r.next=29;break}return r.next=25,e.msalApplication.acquireTokenPopup(u);case 25:f=r.sent,a(f.accessToken),r.next=30;break;case 29:case 30:r.next=36;break;case 32:r.prev=32,r.t1=r.catch(21),i(r.t1);case 36:r.next=40;break;case 38:i(r.t0);case 40:r.next=60;break;case 42:if(r.prev=42,m={scopes:c},!d()){r.next=53;break}return r.next=47,e.msalApplication.loginPopup(m);case 47:return r.next=49,e.msalApplication.acquireTokenSilent(m);case 49:w=r.sent,a(w.accessToken),r.next=55;break;case 53:return n.msalApplication.loginRedirect(m),r.abrupt("return");case 55:r.next=60;break;case 57:r.prev=57,r.t2=r.catch(42),i(r.t2);case 60:case"end":return r.stop()}}),r,null,[[11,18],[21,32],[42,57]])})));return function(t,e){return r.apply(this,arguments)}}())}}]),t}(),v=(n(61),n(78),n(82),["User.Read.All","User.ReadWrite.All"]),k={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,authority:"https://login.microsoftonline.com/common",storeAuthStateInCookie:!0}};new h.b(k).handleRedirectCallback((function(t,e){}));var x={authProvider:new b(new h.b(k),new w.MSALAuthenticationProviderOptions(v))};function g(){return m.a.initWithMiddleware(x)}function y(t){return new Promise(function(){var e=Object(f.a)(p.a.mark((function e(n,r){var a,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g(),e.prev=1,e.next=4,a.api(t).get();case 4:return i=e.sent,e.abrupt("return",n(i));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}())}var O={me:function(){return y("/me")},myExtentions:function(){return y("/me/extensions")},alerts:function(){return y("/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/Service%20Announcements/items")},setExtention:function(t){return function(t,e){return new Promise(function(){var n=Object(f.a)(p.a.mark((function n(r,a){var i,o;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=g(),n.prev=1,n.next=5,i.api(t).post(e);case 5:return o=n.sent,n.abrupt("return",r(o));case 10:return n.prev=10,n.t0=n.catch(1),n.abrupt("return",a(n.t0));case 14:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(t,e){return n.apply(this,arguments)}}())}("/me/extensions/".concat(t.id),t)},updateExtention:function(t){return function(t,e){return new Promise(function(){var n=Object(f.a)(p.a.mark((function n(r,a){var i,o;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=g(),n.prev=1,n.next=4,i.api(t).patch(e);case 4:return o=n.sent,n.abrupt("return",r(o));case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",a(n.t0));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(t,e){return n.apply(this,arguments)}}())}("/me/extensions/".concat(t.id),t)}};var j=function(){function t(){var e=this;Object(s.a)(this,t),this.tools=function(){return new Promise((function(t,e){t([])}))},this.setNotificationCount=function(t,n){var r=window.self!==window.top?window.top:window.self;r&&r.postMessage({action:"setNotificationCount",count:n,tileId:t,key:e._key},e._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(u.a)(t,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),t}();j.init=function(){return new j};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement((function(){var t=Object(r.useState)(!1),e=Object(c.a)(t,2),n=(e[0],e[1],Object(r.useState)([])),i=Object(c.a)(n,2),o=i[0],s=i[1],u=Object(r.useState)({}),l=Object(c.a)(u,2),p=l[0],f=l[1],h=Object(r.useState)([]),m=Object(c.a)(h,2),w=(m[0],m[1],Object(r.useState)({})),d=Object(c.a)(w,2),b=(d[0],d[1]);return Object(r.useEffect)((function(){var t=j.init(),e=localStorage.getItem("ztickyBarNotificationCount"),n=e?parseInt(e):0;t.setNotificationCount(3,n),O.myExtentions().then((function(t){f(t),console.log(t.value[0].etag),b(t.value[0]),j.init().setNotificationCount(3,2)})).catch((function(t){o.push({context:"OfficeGraph.myExtentions() ",error:t}),s(o)})),O.alerts().then((function(t){})).catch((function(t){o.push({context:"OfficeGraph.alerts() ",error:t}),s(o)}))}),[]),a.a.createElement("div",null,"Alarms",a.a.createElement("hr",null),JSON.stringify(p),a.a.createElement("hr",null),JSON.stringify(o),a.a.createElement("hr",null),a.a.createElement("button",{onClick:function(){var t=localStorage.getItem("ztickyBarNotificationCount"),e=t?parseInt(t)>0?parseInt(t)+1:1:0;localStorage.setItem("ztickyBarNotificationCount",e),j.init().setNotificationCount(3,e)}},"+"),a.a.createElement("button",{onClick:function(){var t=localStorage.getItem("ztickyBarNotificationCount"),e=t?parseInt(t)>0?parseInt(t)-1:1:0;localStorage.setItem("ztickyBarNotificationCount",e),j.init().setNotificationCount(3,e)}},"-"))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[51,1,2]]]);
//# sourceMappingURL=main.ab6c1279.chunk.js.map